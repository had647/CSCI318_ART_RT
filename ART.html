<html>

<head>
  <title>ART</title>
  <style>
	/* This is used to have two Canvas Side by Side*/
  	#wrapper {
		display: flex;
	}
	
	#canvasContainer {
		flex: 0 0 35%; /* Change the 35% if you want to move the second Canvas to the right */
	}
	
	#canvasContainer2 {
		flex: 1;
	}
  </style>
  <script>

    //calculates the smallest distance between a candidate case, and all current test cases
    function calculate_min_distance(candiate_x, candiate_y){
      
      let min_distance = -1;  //smallest distance after measuring distance between candidate and all other test cases
      let di = -1;            //distance between the candidate and all test cases
      
      let test_case_x = -1;   //test case coordinates 
      let test_case_y = -1;
    
      let i;
      for(i = 0; i < test_cases.length; i++){     //iterating through each test case
      
        test_case_x = test_cases[i];              //retrieving x coordinate of test case
        i++;
        test_case_y = test_cases[i];              //retrieving y coordinate of test case
      
        di = Math.sqrt( Math.pow((candiate_x - test_case_x), 2)   +   Math.pow((candiate_y - test_case_y), 2));   //equation for measuring distance
        //console.log(di);  //uncomment this if you want to see the distance between the candidate and each test case
        if(i == 1) min_distance = di;             //assume the first distance is the smallest
        if(di < min_distance) min_distance  = di;   //if a smaller distance is found, update the min_distance
      }
      //console.log("----");          //un comment this if you want to see the final output
      //console.log(min_distance);    //"                                                  "
      return min_distance;    
    }

    /*
    //This is a demonstration only. Remove comment block to see the function in action. Also remove the commented console.log() functions in the calculate_min_distance() function.
    //Cheers- Isaac xoxo
    
    //This is an dynamic array of floating point values, so it will grow  much larger than this in the actual program
    //Every value in the array belongs to a pair. Eg. test_case_0(x, y) x = 1.5, y = 2.333    test_case_1(x, y) x = 5, y = 20
    let test_cases = [1.5, 2.333, 5, 20, 151, 251, 150, 250, 45, 499, 344, 99, 66, 77, 188, 219, 455, 401, 30, 14];

    //just a dummy candidate case to test function
    let candiate_x = 45.7;
    let candiate_y = 70.9;

    calculate_min_distance(candiate_x, candiate_y);
    */
    





















    function runTest() {
      let fail_region_percent = parseFloat(document.getElementById("failPct").value) / 100;  //user will change this
      console.log(`Using failure pct: ${fail_region_percent}`);

      let edge_size = parseInt(document.getElementById("edgeSize").value);  //change this to set the HxW of the canvas
      console.log(`Using edge size: ${edge_size}px`);

      if (isNaN(fail_region_percent) || fail_region_percent > 1 || fail_region_percent <= 0 || isNaN(edge_size) || edge_size <= 0) {
        console.log("INVALID");
        return;
      } else {
        console.log("INPUT VALID");
      }

      //this is probably slow - needs optimizing
      document.getElementById("canvasContainer").innerHTML = `<canvas id="myCanvas" width="${edge_size}" height="${edge_size}" style="border:1px solid #c3c3c3;"></canvas>`; //sets height and width based on edge_size
	  document.getElementById("canvasContainer2").innerHTML = `<canvas id="myCanvas" width="${edge_size}" height="${edge_size}" style="border:1px solid #c3c3c3;"></canvas>`;
	  
      let fail_region_edge_size = Math.sqrt(edge_size * edge_size * fail_region_percent);  //width and height of fail region

      let border_limit_max = edge_size - fail_region_edge_size; //determines the maximum x and y coordinate for the fail region to prevent the fail region from being cut off by the border

      let random_x = Math.random() * border_limit_max;  //generates a random number inclusively between 0 and the border_limit_max
      let random_y = Math.random() * border_limit_max;  //" "

      let canvas = document.getElementById("myCanvas");     //setting up canvas stuff
      let ctx = canvas.getContext("2d");                    //setting up the fail region

      let random_x_test_case = Math.random() * edge_size; //these may need to change
      let random_y_test_case = Math.random() * edge_size;

      //collision demonstration
      if ((random_x_test_case >= random_x && random_x_test_case <= (random_x + fail_region_edge_size)
        && random_y_test_case >= random_y && (random_y_test_case <= random_y + fail_region_edge_size))) {
        console.log("COLLISION");
        document.getElementById("output_result").innerHTML = "HIT!";
        ctx.fillStyle = "red";                            //colour of fail region
        ctx.fillRect(random_x, random_y, fail_region_edge_size, fail_region_edge_size);

      } else { //no collision occurs
        ctx.fillStyle = "green";                            //colour of fail region
        ctx.fillRect(random_x, random_y, fail_region_edge_size, fail_region_edge_size);       //rendering the fail region
        document.getElementById("output_result").innerHTML = "MISSED!";
      }

      ctx.fillStyle = "black";
      ctx.beginPath();
      ctx.arc(random_x_test_case, random_y_test_case, 5, 0, 2 * Math.PI);
      ctx.stroke();
      ctx.fill();
    }

  </script>
</head>

<body>
  <span>Enter failure area percentage:</span>
  <input type="text" id="failPct"></input>
  <span>%</span>
  
  <br />
  
  <span>Enter edge size as an integer:</span>
  <input type="text" id="edgeSize"></input>
  <span>px   <i>(For display purposes, we recommend the range 250px to 800px.)</i></span> <br />  <br />

  <button onclick="runTest()">Go!</button> <br /><br />
  
  <div id= "wrapper">
	<div id="canvasContainer"></div> 
	<div id="canvasContainer2"></div>
  </div>
  
  <br />
  
  <div id="output_result"></div>

</body>

</html>